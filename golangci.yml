run:
  timeout: 5m
  tests: true
  modules-download-mode: readonly

linters-settings:
  gofmt:
    simplify: true
  goimports:
    local-prefixes: github.com/Conceptual-Machines/magda-api
  govet:
    check-shadowing: true
  gocyclo:
    min-complexity: 15
  maligned:
    suggest-new: true
  dupl:
    threshold: 100
  goconst:
    min-len: 2
    min-occurrences: 2
  misspell:
    locale: US
  lll:
    line-length: 140
  unused:
    check-exported: false
  whitespace:
    multi-if: false
    multi-func: false
  gomodguard:
    allowed-modules: []
    blocked-modules:
      - github.com/go-playground/validator/v10/translations/sl
      - github.com/go-playground/validator/v10/translations/ja
  gomoddirectives:
    replace-allow-list:
      - github.com/fatih/color
  interfacer:
    suggest-new: true

linters:
  enable:
    - gofmt
    - govet
    - errcheck
    - staticcheck
    - unused
    - gosimple
    - ineffassign
    - gocyclo
    - dupl
    - goconst
    - mnd
    - lll
    - whitespace
    - makezero
    - nolintlint
    - thelper
    - exhaustive
    - copyloopvar
    - revive
  disable:
    - goimports # Run separately with pinned version
    - prealloc
    - misspell # Disable annoying US vs UK spelling differences

issues:
  exclude-rules:
    - path: _test\.go
      linters:
        - dupl
        - gomnd
        - mnd
        - gocyclo
        - goconst
        - thelper
        - govet
    # magda.go contains prompt documentation with similar DSL examples in different sections (false positive)
    - path: internal/prompt/magda\.go
      linters:
        - dupl
        - lll
        - nolintlint
    # Agent code merged from magda-agents-go - has music-specific constants and complex parsing
    - path: internal/agents/.*\.go
      linters:
        - mnd
        - goconst
        - lll
        - makezero
        - gocyclo
        - exhaustive
        - revive
        - nolintlint
        - gosimple
    # LLM provider has complex response handling logic
    - path: internal/llm/.*\.go
      linters:
        - mnd
        - goconst
        - lll
        - gocyclo
        - nolintlint
        - revive
        - unused
